{
    "collab_server" : "",
    "contents" : "library(\"shiny\")\nsource(\"R/helper.R\")\n\n# save values module\n\n\n\nsaveData <- function(data, location, partId, checkNull = TRUE, addNameList = NULL, suffix = \"_s\",\n                     outputDir = NULL, droptoken = NULL, asrds = FALSE){\n\t# The function takes a list of data and a Location to store it to\n\t# and creates a dataframe that will be stored.\n    \n\t  if (checkNull){\n\t    # get rid of NULLs by replacing them with NAs\n\t  \tdata.new <- lapply(data, convertNull)\n\t  }\n  \n    # create data frame\n  \tdata.df <- as.data.frame(data.new)\n  \t\n\t  if (!is.null(addNameList)) {\n\t    # if column names should be changed replace old ones\n\t\t  names(data.df) <- addNames\n\t  }\n  \t\n  \tif (missing(partId)) {\n  \t  parId <- paste0(sample(c(0:9, letters), 9), collapse = \"\")\n  \t}\n  \t# Create a unique file name for data\n  \tDatafileName <- paste0(partId,\n  \t                       as.integer(Sys.time()),\n  \t                       digest::digest(data.df),\n  \t                       suffix,\n  \t                       \".csv\")\n  \t\n  \tincProgress(.5)\n  \t\n  \tif(location == \"dropbox\") {\n  \t  \n  \t  DatafilePath <- file.path(tempdir(), DatafileName)\n  \t  write.csv(data.df, DatafilePath, row.names = FALSE, quote = TRUE)\n  \t  \n  \t  # Upload data to dropbox using \n  \t  rdrop2::drop_upload(DatafilePath,   \n  \t                      dest = outputDir,     # File directory in dropbox\n  \t                      dtoken = droptoken)   # Unique dropbox token\n  \t  \n  \t} else if (location == \"local\"){\n  \t  \n  \t  if (!is.null(outputDir)){\n  \t    DatafilePath <- file.path(outputDir, DatafileName)\n  \t  } else {\n  \t    DatafilePath <- file.path(DatafileName)\n  \t  }\n  \t  \n  \t  if (asrds == TRUE) {\n  \t    saveRDS(data.df, DatafilePath)\n  \t  } else {\n  \t    write.csv(data.df, DatafilePath, row.names = FALSE, quote = TRUE)\n  \t  }\n  \t  \n  \t} else if (location == \"email\"){\n  \t  \n  \t  # maybe sendmailR or mailR packages but it's probably tricky especially with lot's of mails being sent so the mail account might block further mails (especially gmail)\n  \t  warning(\"email is currently not working as saveDataLocation. No data has been stored. Use dropbox or local.\")\n  \t}\n\n}",
    "created" : 1500646980493.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2047495960",
    "id" : "A062D63F",
    "lastKnownWriteTime" : 1500646987,
    "last_content_update" : 1500646987171,
    "path" : "C:/Users/Markus/switchdrive/shinyPsych/R/save_data.R",
    "project_path" : "R/save_data.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}