{
    "collab_server" : "",
    "contents" : "#' Append Input from Decisions from Experience Task to Task Control List\n#'\n#' After a gamble in the decisions from experience task is ended the data is\n#' sent from the browser to the current r session and is then with this function\n#' appended to the task control list (gameData) which has to be a reactive value\n#' (see \\code{\\link[shiny]{reactiveValues}} or\n#' \\url{https://shiny.rstudio.com/reference/shiny/latest/reactiveValues.html}).\n#' @param ctrlVals list of reactive values. Controls the flow through the\n#'  Experiment. Can be created with \\code{\\link{createCtrlList}}.\n#' @param input The input object from a shiny app.\n#' @param gameData list of reactive values.Sspecifically for the bandit task.\n#'  Can be created with \\code{\\link{createTaskCtrlList}}.\n#' @param container list. Containing at least two objects named \"trial.order\"\n#'  and \"gamle.order\". Usually this list is created with\n#'  \\code{\\link{createDfeList}}.\n#' @param withPracticeGamble logical. If TRUE it is assumed that a practice\n#'  gamble was included. The page after that trial will be afterPracticePage.\n#' @param afterPracticePage string. The name of the page to be shown\n#'  after the practice trial. Only needs to be specified if withPracticeGamble\n#'  is set to TRUE.\n#' @param afterGamblePage string. The name of the page to be shown after the\n#'  trials up to the second to last trial.\n#' @param afterLastGamblePage string. The name of the page to be shown after\n#'  the last trial.\n#'\n#' @return gameData list of reactive values and change current page\n#' value (note: does not have to be assigned when function is called).\n#' @export\n#'\n#' @examples\nappendDfeValues <- function(ctrlVals, input, gameData, container,\n                            withPracticeGamble = TRUE,\n                            afterPracticePage = \"postPractice\",\n                            afterGamblePage = \"endGame\",\n                            afterLastGamblePage = \"lastEndGame\"){\n\n  index <- (length(input$trial) -\n              (length(input$gambleNr[input$gambleNr == ctrlVals$dfeGamble]) - 1)) :\n    length(input$trial)\n\n  # append values to task control reactive list\n  gameData$trial <- c(gameData$trial, input$trial[index])\n\n  gameData$time <- c(gameData$time, input$respTime[index])\n\n  gameData$selected <- c(gameData$selected,\n                          rep(input$selected[length(input$selected)],\n                              length(index)))\n\n  gameData$finalOutcome <- c(gameData$finalOutcome,\n                          rep(input$finalOutcome[length(input$finalOutcome)],\n                              length(index)))\n\n  gameData$samples <- c(gameData$samples, input$samples[index])\n\n  gameData$outcome <- c(gameData$outcome, input$outcome[index])\n\n  gameData$gamble <- c(gameData$gamble, input$gambleNr[index])\n\n  orderIndex <- (((gameData$gamble[length(gameData$gamble)] - 1) *\n                    container$nDraws) + 1) :\n    (((gameData$gamble[length(gameData$gamble)] - 1) * container$nDraws) +\n       length(index))\n\n  gameData$option.order <- c(gameData$option.order,\n                             container$option.order[orderIndex])\n\n  gameData$gamble.order <- c(gameData$gamble.order,\n                             rep(container$gamble.order[ctrlVals$dfeGamble],\n                                 length(index)))\n\n\n  # change page and gamble index variable\n  if (isTRUE(withPracticeGamble)){\n\n    if (ctrlVals$dfeGamble == 1){\n\n      ctrlVals$page <- afterPracticePage\n\n      ctrlVals$dfeGamble <- unique(gameData$gamble)[length(unique(gameData$gamble))] + 1\n\n    } else if (any(c(2:(nrow(container$gamble.df) - 1)) == ctrlVals$dfeGamble)){\n\n      ctrlVals$page <- afterGamblePage\n\n      ctrlVals$dfeGamble <- unique(gameData$gamble)[length(unique(gameData$gamble))] + 1\n\n    } else {\n\n      ctrlVals$page <- afterLastGamblePage\n\n      ctrlVals$dfeGamble <- unique(gameData$gamble)[length(unique(gameData$gamble))] + 1\n    }\n  } else{\n\n    if (any(seq_len(nrow(container$gamble.df) - 1) == ctrlVals$dfeGamble)){\n\n      ctrlVals$page <- afterGamblePage\n\n      ctrlVals$dfeGamble <- unique(gameData$gamble)[length(unique(gameData$gamble))] + 1\n    } else {\n\n      ctrlVals$page <- afterLastGamblePage\n\n      ctrlVals$dfeGamble <- unique(gameData$gamble)[length(unique(gameData$gamble))] + 1\n\n    }\n  }\n}\n",
    "created" : 1503932430317.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "291277672",
    "id" : "86AC2FB6",
    "lastKnownWriteTime" : 1503988757,
    "last_content_update" : 1503988757720,
    "path" : "C:/Users/Markus/switchdrive/packages/ShinyPsych/R/append_dfe_values.R",
    "project_path" : "R/append_dfe_values.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}